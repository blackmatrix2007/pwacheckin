(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1203:(e,t,n)=>{Promise.resolve().then(n.bind(n,3647))},3647:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});var s=n(5155),r=n(2115);let a="pwa_checkins",c=async e=>{try{if(await new Promise(e=>setTimeout(e,1e3)),.1>Math.random())throw Error("Network error");let t=l(),n={...e,synced:!0};return i([n,...t]),console.log("API: Check-in saved successfully",n),n}catch(e){throw console.error("API error:",e),e}},l=()=>{try{let e=localStorage.getItem(a);return e?JSON.parse(e):[]}catch(e){return console.error("Error reading from localStorage:",e),[]}},i=e=>{try{localStorage.setItem(a,JSON.stringify(e))}catch(e){console.error("Error saving to localStorage:",e)}};function o(){let[e,t]=(0,r.useState)(!0),[n,a]=(0,r.useState)(""),[l,i]=(0,r.useState)([]),[o,d]=(0,r.useState)(!1),[h,m]=(0,r.useState)(""),u=async e=>{try{return await c(e)}catch(e){throw console.error("API error:",e),e}},x=(0,r.useCallback)(async()=>{if(!e)return;let t=l.filter(e=>!e.synced);if(0!==t.length){for(let e of(m("Syncing ".concat(t.length," check-ins...")),t))try{let t=await u(e);i(n=>n.map(n=>n.id===e.id?t:n)),m("Synced ".concat(e.location))}catch(e){console.error("Failed to sync check-in:",e),m("Failed to sync some check-ins")}setTimeout(()=>m(""),3e3)}},[l,e,m]);(0,r.useEffect)(()=>{t(navigator.onLine);let e=()=>{t(!0),x()},n=()=>{t(!1)};window.addEventListener("online",e),window.addEventListener("offline",n);let s=localStorage.getItem("checkIns");return s&&i(JSON.parse(s)),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}},[x]),(0,r.useEffect)(()=>{l.length>0&&localStorage.setItem("checkIns",JSON.stringify(l))},[l]);let g=async()=>{if(!n.trim()){alert("Please enter a location");return}d(!0);let e={id:Date.now().toString(),timestamp:Date.now(),location:n.trim(),synced:!1};i(t=>[e,...t]);try{let t=await u(e);i(n=>n.map(n=>n.id===e.id?{...t}:n))}catch(e){console.error("Failed to sync check-in:",e),m("Failed to sync check-in. Will retry when online."),setTimeout(()=>m(""),3e3)}a(""),d(!1)},y=e=>new Date(e).toLocaleString();return(0,s.jsxs)("div",{className:"min-h-screen p-4 max-w-md mx-auto",children:[(0,s.jsxs)("header",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"PWA Check-in App"}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e?"bg-green-500":"bg-red-500")}),(0,s.jsx)("p",{className:"text-sm",children:e?"Online":"Offline"})]}),h&&(0,s.jsx)("p",{className:"text-sm text-blue-500 mt-1",children:h})]}),(0,s.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-4 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"New Check-in"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:n,onChange:e=>a(e.target.value),placeholder:"Enter location",className:"flex-1 border rounded p-2"}),(0,s.jsx)("button",{onClick:g,disabled:o,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 disabled:bg-blue-300",children:o?"Checking in...":"Check In"})]})]}),(0,s.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"Check-in History"}),0===l.length?(0,s.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No check-ins yet"}):(0,s.jsx)("ul",{className:"divide-y",children:l.map(e=>(0,s.jsxs)("li",{className:"py-3",children:[(0,s.jsx)("p",{className:"font-medium",children:e.location}),(0,s.jsxs)("div",{className:"flex justify-between text-sm text-gray-500",children:[(0,s.jsx)("span",{children:y(e.timestamp)}),(0,s.jsx)("span",{className:e.synced?"text-green-500":"text-orange-500",children:e.synced?"Synced":"Not synced"})]})]},e.id))})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,587,358],()=>t(1203)),_N_E=e.O()}]);